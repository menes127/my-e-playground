CREATE SCHEMA PUBLIC AUTHORIZATION DBA
CREATE MEMORY TABLE ACL_SID(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,PRINCIPAL INTEGER,SID VARCHAR(100),CONSTRAINT PK_ACL_SID PRIMARY KEY(ID),CONSTRAINT UK_ACL_SID UNIQUE(SID,PRINCIPAL))
CREATE MEMORY TABLE ACL_CLASS(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,CLASS VARCHAR(100),CONSTRAINT PK_SCL_CLASS PRIMARY KEY(ID),CONSTRAINT UK_ACL_CLASS UNIQUE(CLASS))
CREATE MEMORY TABLE ACL_OBJECT_IDENTITY(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,OBJECT_ID_CLASS BIGINT,OBJECT_ID_IDENTITY BIGINT,PARENT_OBJECT BIGINT,OWNER_SID BIGINT,ENTRIES_INHERITING INTEGER,CONSTRAINT PK_ACL_OBJECT_IDENTITY PRIMARY KEY(ID),CONSTRAINT UK_OBJECT_IDENTITY UNIQUE(OBJECT_ID_CLASS,OBJECT_ID_IDENTITY),CONSTRAINT FK_OBJECT_IDENTITY_PARENT_OBJECT FOREIGN KEY(PARENT_OBJECT) REFERENCES ACL_OBJECT_IDENTITY(ID),CONSTRAINT FK_OBJECT_IDENTITY_OBJECT_ID_CLASS FOREIGN KEY(OBJECT_ID_CLASS) REFERENCES ACL_CLASS(ID),CONSTRAINT FK_OBJECT_IDENTITY_OWNER_SID FOREIGN KEY(OWNER_SID) REFERENCES ACL_SID(ID))
CREATE MEMORY TABLE ACL_ENTRY(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,ACL_OBJECT_IDENTITY BIGINT,ACE_ORDER INTEGER,SID BIGINT,MASK INTEGER,GRANTING INTEGER,AUDIT_SUCCESS INTEGER,AUDIT_FAILURE INTEGER,CONSTRAINT PK_ACL_ENTRY PRIMARY KEY(ID),CONSTRAINT UK_ACL_ENTRY UNIQUE(ACL_OBJECT_IDENTITY,ACE_ORDER),CONSTRAINT FK_ACL_ENTRY_ACL_OBJECT_IDENTITY FOREIGN KEY(ACL_OBJECT_IDENTITY) REFERENCES ACL_OBJECT_IDENTITY(ID),CONSTRAINT FK_ACL_ENTRY_SID FOREIGN KEY(SID) REFERENCES ACL_SID(ID))
ALTER TABLE ACL_SID ALTER COLUMN ID RESTART WITH 104
ALTER TABLE ACL_CLASS ALTER COLUMN ID RESTART WITH 103
ALTER TABLE ACL_OBJECT_IDENTITY ALTER COLUMN ID RESTART WITH 114
ALTER TABLE ACL_ENTRY ALTER COLUMN ID RESTART WITH 112
CREATE USER SA PASSWORD ""
GRANT DBA TO SA
SET WRITE_DELAY 10
SET SCHEMA PUBLIC
INSERT INTO ACL_SID VALUES(100,1,'user')
INSERT INTO ACL_SID VALUES(101,0,'ROLE_ADMIN')
INSERT INTO ACL_SID VALUES(102,0,'ROLE_USER')
INSERT INTO ACL_SID VALUES(103,1,'admin')
INSERT INTO ACL_CLASS VALUES(100,'com.family168.springsecuritybook.ch302.Account')
INSERT INTO ACL_CLASS VALUES(101,'com.family168.springsecuritybook.ch302.Message')
INSERT INTO ACL_CLASS VALUES(102,'com.family168.springsecuritybook.ch302.Contract')
INSERT INTO ACL_OBJECT_IDENTITY VALUES(100,100,1248166223231,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(101,100,1248177486344,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(102,101,1248177687996,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(103,100,1248178873242,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(104,100,1248179457688,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(105,102,1248179464798,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(106,100,1248179540323,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(107,102,1248179545761,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(108,100,1248180000573,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(109,100,1248180073184,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(110,100,1248180181485,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(111,100,1248180497339,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(112,100,1248180555622,NULL,100,1)
INSERT INTO ACL_OBJECT_IDENTITY VALUES(113,100,1248190488685,NULL,100,1)
INSERT INTO ACL_ENTRY VALUES(100,100,0,100,16,1,0,0)
INSERT INTO ACL_ENTRY VALUES(101,100,1,101,8,1,0,0)
INSERT INTO ACL_ENTRY VALUES(102,100,2,102,1,1,0,0)
INSERT INTO ACL_ENTRY VALUES(103,110,0,100,16,1,0,0)
INSERT INTO ACL_ENTRY VALUES(104,110,1,103,16,1,0,0)
INSERT INTO ACL_ENTRY VALUES(105,111,0,100,16,1,0,0)
INSERT INTO ACL_ENTRY VALUES(106,111,1,103,16,1,0,0)
INSERT INTO ACL_ENTRY VALUES(109,112,0,100,16,1,0,0)
INSERT INTO ACL_ENTRY VALUES(110,113,0,100,16,1,0,0)
INSERT INTO ACL_ENTRY VALUES(111,113,1,103,1,1,0,0)
